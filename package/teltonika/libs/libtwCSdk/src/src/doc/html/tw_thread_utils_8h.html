<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>ThingWorx C SDK: /home/ubuntu/jenkins/workspace/tw-c-sdk-cmake-linux-build-test-master/tw-c-sdk/src/threadUtils/twThreadUtils.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ThingWorx C SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_cdc56141a772578236b34c32ade287a2.html">threadUtils</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">twThreadUtils.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Provides simple thread management for ThingWorx C SDK functionality.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="tw_o_s_port_8h_source.html">twOSPort.h</a>&quot;</code><br />
<code>#include &quot;twMap.h&quot;</code><br />
</div>
<p><a href="tw_thread_utils_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtw_polled_function_record.html">twPolledFunctionRecord</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a225bfb7b8168e3c22cb651631bda29ec"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a225bfb7b8168e3c22cb651631bda29ec"></a>
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><b>twOnPolled</b>) (char *entityName)</td></tr>
<tr class="separator:a225bfb7b8168e3c22cb651631bda29ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca6e0e288b1e431e730f3522e5f67db4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aca6e0e288b1e431e730f3522e5f67db4"></a>
typedef struct <a class="el" href="structtw_polled_function_record.html">twPolledFunctionRecord</a>&#160;</td><td class="memItemRight" valign="bottom"><b>twPolledFunctionListRecord</b></td></tr>
<tr class="separator:aca6e0e288b1e431e730f3522e5f67db4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aa0dda5265a63200c75c3791223deb647"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa0dda5265a63200c75c3791223deb647"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>twThreadingModel</b> { <b>TW_THREADING_SINGLE</b> =0, 
<b>TW_THREADING_TASKER</b> =1, 
<b>TW_THREADING_MULTI</b> =2
 }</td></tr>
<tr class="separator:aa0dda5265a63200c75c3791223deb647"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a11b2b4690402c75ca0c63bf9dc7ba902"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tw_thread_utils_8h.html#a11b2b4690402c75ca0c63bf9dc7ba902">twExt_RegisterPolledTemplateFunction</a> (twOnPolled polledFunction, char *templateName)</td></tr>
<tr class="separator:a11b2b4690402c75ca0c63bf9dc7ba902"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7826c15823cf8a0188df0ff57be9d324"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tw_thread_utils_8h.html#a7826c15823cf8a0188df0ff57be9d324">twExt_RegisterPolledShapeFunction</a> (twOnPolled polledFunction, char *shapeName)</td></tr>
<tr class="separator:a7826c15823cf8a0188df0ff57be9d324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99ffc1af5e9db6b80d8f36fa99a23949"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tw_thread_utils_8h.html#a99ffc1af5e9db6b80d8f36fa99a23949">twExt_RemovePolledFunction</a> (twOnPolled polledFunction)</td></tr>
<tr class="separator:a99ffc1af5e9db6b80d8f36fa99a23949"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79bc929936d13439b672adf867b2de78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tw_thread_utils_8h.html#a79bc929936d13439b672adf867b2de78">twExt_PerformPolledFunctions</a> (<a class="el" href="tw_windows_8h.html#ab4c093a467fa049d2277efd11a62a004">DATETIME</a> now, void *params)</td></tr>
<tr class="separator:a79bc929936d13439b672adf867b2de78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b9f809e951ca2d1519cc4d3d870511c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tw_thread_utils_8h.html#a2b9f809e951ca2d1519cc4d3d870511c">twExt_Idle</a> (uint32_t intervalMsec, enum twThreadingModel threadingModel, uint32_t messageHandlerThreadCount)</td></tr>
<tr class="separator:a2b9f809e951ca2d1519cc4d3d870511c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadaa0b194246565fe460b851efae8902"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tw_thread_utils_8h.html#aadaa0b194246565fe460b851efae8902">twExt_Start</a> (uint32_t dataCollectionRate, enum twThreadingModel threadingModel, uint32_t messageHandlerThreadCount)</td></tr>
<tr class="separator:aadaa0b194246565fe460b851efae8902"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae551caabdc5bdba531a4f4202ee247a5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tw_thread_utils_8h.html#ae551caabdc5bdba531a4f4202ee247a5">twExt_Stop</a> ()</td></tr>
<tr class="separator:ae551caabdc5bdba531a4f4202ee247a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5c23292df5e4095cc6500227e59d622"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tw_thread_utils_8h.html#ab5c23292df5e4095cc6500227e59d622">twExt_WaitUntilFirstSynchronization</a> (uint32_t timeoutMills)</td></tr>
<tr class="separator:ab5c23292df5e4095cc6500227e59d622"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Provides simple thread management for ThingWorx C SDK functionality. </p>
<dl class="section author"><dt>Author</dt><dd><a href="#" onclick="location.href='mai'+'lto:'+'bil'+'l.'+'rei'+'ch'+'ard'+'t@'+'thi'+'ng'+'wor'+'x.'+'com'; return false;">bill.<span style="display: none;">.nosp@m.</span>reic<span style="display: none;">.nosp@m.</span>hardt<span style="display: none;">.nosp@m.</span>@thi<span style="display: none;">.nosp@m.</span>ngwor<span style="display: none;">.nosp@m.</span>x.co<span style="display: none;">.nosp@m.</span>m</a></dd></dl>
<p>This module introduces two thread management functions, <a class="el" href="tw_thread_utils_8h.html#a2b9f809e951ca2d1519cc4d3d870511c">twExt_Idle()</a> and <a class="el" href="tw_thread_utils_8h.html#aadaa0b194246565fe460b851efae8902">twExt_Start()</a>. Both functions can be called to establish the minimum number of support threads and services to manage an Always-On connection to ThingWorx. The main difference is that <a class="el" href="tw_thread_utils_8h.html#a2b9f809e951ca2d1519cc4d3d870511c">twExt_Idle()</a> will not return until your application is terminated. Any thread used to call this function will not exit. <a class="el" href="tw_thread_utils_8h.html#a2b9f809e951ca2d1519cc4d3d870511c">twExt_Idle()</a> is useful in situations where your application only wants to start up services and then idle until it is exited.</p>
<p><a class="el" href="tw_thread_utils_8h.html#aadaa0b194246565fe460b851efae8902">twExt_Start()</a> assumes that you are starting up Always-On services as part of your application's normal start up process and need the calling thread to return once this is done to continue with operations you may need to perform as part of you startup process.</p>
<p>Both functions set up periodic calls to any polled functions you declare which will be bound to specific Thing Shapes or Thing Templates. Periodic polled functions, often referred to as "Process Scan Request" functions can be declared against any Edge Thing Shape or Template using the <a class="el" href="tw_thread_utils_8h.html#a11b2b4690402c75ca0c63bf9dc7ba902">twExt_RegisterPolledTemplateFunction()</a> and <a class="el" href="tw_thread_utils_8h.html#a7826c15823cf8a0188df0ff57be9d324">twExt_RegisterPolledShapeFunction()</a> functions can can be used to generate simulated data or to poll hardware for new data in your Thing or Shape. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2b9f809e951ca2d1519cc4d3d870511c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void twExt_Idle </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>intervalMsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum twThreadingModel&#160;</td>
          <td class="paramname"><em>threadingModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>messageHandlerThreadCount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Call this function if you want this thread to take control of polling any registered polled functions. This function will not exit until the application is terminated. Choice of threading models is: TW_THREADING_SINGLE - Use the thread this function is called on to service registered polled functions TW_THREADING_TASKER - Use the built in tasker functionally of the C SDK to call all polled functions. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">intervalMsec</td><td>Polling period in milliseconds. </td></tr>
    <tr><td class="paramname">threadingModel</td><td>Threading model to use. </td></tr>
    <tr><td class="paramname">messageHandlerThreadCount</td><td>Number of message handling threads to spawn. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a79bc929936d13439b672adf867b2de78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void twExt_PerformPolledFunctions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tw_windows_8h.html#ab4c093a467fa049d2277efd11a62a004">DATETIME</a>&#160;</td>
          <td class="paramname"><em>now</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A tasker style handler function which can be called directly or by the tasker to execute all registered polled functions for any Template or Shape.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">now</td><td>Unused. </td></tr>
    <tr><td class="paramname">params</td><td>Unused. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7826c15823cf8a0188df0ff57be9d324"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void twExt_RegisterPolledShapeFunction </td>
          <td>(</td>
          <td class="paramtype">twOnPolled&#160;</td>
          <td class="paramname"><em>polledFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>shapeName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Register a callback function that takes a single char* that will be called once for each Thing that uses the thing shape "shapeName". Use this function to add polled or processScanRequest style functions that should be called on any thing based on this thing shape. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">polledFunction</td><td>A function using the style defined by twOnPolled. Ex. myPolledFunction(char* entityName); </td></tr>
    <tr><td class="paramname">shapeName</td><td>The name of the shape this function should be attached to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a11b2b4690402c75ca0c63bf9dc7ba902"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void twExt_RegisterPolledTemplateFunction </td>
          <td>(</td>
          <td class="paramtype">twOnPolled&#160;</td>
          <td class="paramname"><em>polledFunction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>templateName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Register a callback function that takes a single char* that will be called once for each Thing that uses the template "templateName". Use this function to add polled or processScanRequest style functions that should be called on any thing based on this template. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">polledFunction</td><td>A function using the style defined by twOnPolled. Ex. myPolledFunction(char* entityName); </td></tr>
    <tr><td class="paramname">templateName</td><td>The name of the template this function should be attached to. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a99ffc1af5e9db6b80d8f36fa99a23949"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void twExt_RemovePolledFunction </td>
          <td>(</td>
          <td class="paramtype">twOnPolled&#160;</td>
          <td class="paramname"><em>polledFunction</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove the polled function from the list of active polled functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">polledFunction</td><td>A pointer to the polled function to be removed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aadaa0b194246565fe460b851efae8902"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void twExt_Start </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>dataCollectionRate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum twThreadingModel&#160;</td>
          <td class="paramname"><em>threadingModel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>messageHandlerThreadCount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Starts a thread to monitor all things with registered polled functions. Use this function if you want control of the calling thread to perform other work inside your application. This function relies on the tasker to call polled functions on a thread it creates. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">intervalMsec</td><td>Polling period in milliseconds. </td></tr>
    <tr><td class="paramname">threadingModel</td><td>Threading model to use. </td></tr>
    <tr><td class="paramname">messageHandlerThreadCount</td><td>Number of message handling threads to spawn. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae551caabdc5bdba531a4f4202ee247a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int twExt_Stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Shut down all threads associated with your current threading model. You should call <a class="el" href="tw_thread_utils_8h.html#ae551caabdc5bdba531a4f4202ee247a5">twExt_Stop()</a> before <a class="el" href="tw_api_8h.html#a1916215b5103eb36abd74088d81cd166" title="Unbinds any bound entities and disconnects from the ThingWorx server. ">twApi_Disconnect()</a> when shutting down your active threading model. </p><dl class="section return"><dt>Returns</dt><dd>TW_OK is succeeds, otherwise TW_THREADING_MODEL_FAILED_SHUTDOWN </dd></dl>

</div>
</div>
<a class="anchor" id="ab5c23292df5e4095cc6500227e59d622"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int twExt_WaitUntilFirstSynchronization </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>timeoutMills</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Block until it can confirm that you have received at least one synchronization message from the server. It can be used to wait until your application is cleared to start posting property changes. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timeoutMills</td><td>Maximum wait time in milliseconds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TW_OK is succeeds, otherwise TW_SUBSCRIBED_PROPERTY_SYNCHRONIZATION_TIMEOUT </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Feb 27 2019 14:44:44 for ThingWorx C SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
