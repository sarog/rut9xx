Index: linux-5.4.147/fs/fs_context.c
===================================================================
--- linux-5.4.147.orig/fs/fs_context.c
+++ linux-5.4.147/fs/fs_context.c
@@ -585,7 +585,7 @@ static int legacy_parse_param(struct fs_
 			      param->key);
 	}
 
-	if (len > PAGE_SIZE - 2 - size)
+	if (size + len + 2 > PAGE_SIZE)
 		return invalf(fc, "VFS: Legacy: Cumulative options too large");
 	if (strchr(param->key, ',') ||
 	    (param->type == fs_value_is_string &&
